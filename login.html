<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>התחברות</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h1>התחברות</h1>
  <form id="loginForm">
    <input type="email" name="email" placeholder="אימייל" required>
    <input type="password" name="password" placeholder="סיסמה" required>
    <button>התחבר</button>
  </form>
  <div id="msg" class="error"></div>
  <p><a href="forgot.html">שכחת סיסמה?</a></p>
</div>
<script>
const f = document.getElementById('loginForm');
const msg = document.getElementById('msg');

f.addEventListener('submit', async e => {
  e.preventDefault();
  msg.textContent = '';
  
  const d = Object.fromEntries(new FormData(f).entries());
  
  const r = await fetch('/api/login', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(d)
  });
  
  const data = await r.json().catch(() => ({}));
  
  if (!r.ok) {
    msg.textContent = data.error || 'התחברות נכשלה';
    return;
  }
  
  location.href = '/index.html';
});
</script>
</body>
</html>
